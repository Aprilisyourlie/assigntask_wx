<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.nju.assigntask.dao.UserreceiveMapper">
  <resultMap id="BaseResultMap" type="com.nju.assigntask.entity.Userreceive">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <result column="userId" jdbcType="INTEGER" property="userid" />
    <result column="subtaskid" jdbcType="INTEGER" property="subtaskid" />
    <result column="score1" jdbcType="VARCHAR" property="score1" />
    <result column="score2" jdbcType="VARCHAR" property="score2" />
  </resultMap>
  <insert id="insert" parameterType="com.nju.assigntask.entity.Userreceive">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into userreceive (userId, taskId, score1,
      score2)
    values (#{userid,jdbcType=INTEGER}, #{taskid,jdbcType=INTEGER}, #{score1,jdbcType=VARCHAR}, 
      #{score2,jdbcType=VARCHAR})
  </insert>
  <select id="selectAll" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select userId, taskId, score1, score2
    from userreceive
  </select>

  <select id="findByUserId" resultType="com.nju.assigntask.entity.Userreceive">
    select * from userreceive where userid = #{userid}
  </select>

  <select id="selectScore1BySubtaskId" resultType="double">
    select IFNULL(score1,-1) as score1 from userreceive where subtaskid=#{subtaskid}
  </select>
  <select id="selectScore2BySubtaskId" resultType="double">
    select IFNULL(score2,-1) as score2 from userreceive where subtaskid=#{subtaskid}
  </select>

  <select id="selectAveScore1" resultType="int">
    select IFNULL(AVG(score1),0) as score1 from userreceive where subtaskid=#{subtaskid}
  </select>
  <select id="selectAveScore2" resultType="int">
    select IFNULL(AVG(score2),0) as score2 from userreceive where subtaskid=#{subtaskid}
  </select>
  <select id="selectReleaseIdByUser" resultType="int">
    select releaseid from userreceive where userid = #{userid}
  </select>

  <insert id="insertSubTask" parameterType="com.nju.assigntask.entity.Userreceive">
    insert into userreceive (userid,subtaskid,dividedid) values (#{0},#{1},#{2})
  </insert>

  <update id="updateScore" parameterType="com.nju.assigntask.entity.Userreceive">
    update userreceive set score1 = #{score1} ,score2 = #{score2}
    where dividedid = #{dividedid} and userid = #{userid} and subtaskid = #{subtaskid}
  </update>

</mapper>